{% load widget_tweaks %}

{%load static %}

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <style>
        section{
            padding: 60px 0;
        }
    </style>
    <title>Active Directory Portal | Change Password</title>
</head>
<body class="d-flex h-100 text-center text-white bg-dark">

    <div class="cover-container d-flex w-100 h-100 p-3 mx-auto flex-column" style="min-width: 100vh; min-height: 100vh;">
        <header class="mb-auto">
          <div>
            <h3 class="float-md-start mb-0">3INSYS</h3>
            <a href="{% url 'users_login' %}" type="button" class="btn btn-primary float-md-end mb-0 ms-1">Login</a>
            <a href="{% url 'register' %}" type="button" class="btn btn-outline-light float-md-end mb-0 ">Register</a>
          </div>
        </header>
      
        <main class="px-3">
          <span style="font-size: 4rem; color: cornflowerblue;" >
            <i class="bi bi-people-fill"></i>
          </span>
          <h1>ACTIVE DIRECTORY TOOL</h1>
          <p class="lead">CHANGE PASSWORD FOR PORTAL ACCESS</p>
          <div class="justify-content-center w-25 mx-auto">
            <div class="card">
                <div class="card-header mb-3">
                    <h5 class="card-title">CHANGE PASSWORD</h5>
                </div>
                <div class="card-body">
                  {% if failed %}
                  <div class="alert alert-success" role="alert">
                    <small>
                        <p>Couldn't change the password for one of the following reasons:</p>
                        <ul>
                            <li class="text-start">
                              Please make sure your old password is correct.
                            </li>
                            <li class="text-start">
                                Please make sure the password is meeting the requirements.
                            </li>
                          </ul>
                    </small>
                </div>
                {% endif %}
                  
                  <form method="post" oninput='new_password2.setCustomValidity(new_password2.value != new_password1.value ? "Passwords do not match." : "")'>
                    
                    {% csrf_token %}

                    <div class="input-group mb-3">
                        <span class="input-group-text" id="basic-addon1"><i class="bi bi-person-fill"></i></span>
                        <input class="form-control" type="text" placeholder="{{user}}" aria-label="Disabled input example" disabled>
                        
                        <!-- Tooltip -->
                        <span class="input-group-text" id="basic-addon1">
                          <span class="tt lead" data-bs-placement="bottom" title="Current logged in user">
                            <i class="bi bi-question-circle text-muted"></i>
                            </span>
                        </span>
                    </div>

                    <div class="input-group mb-3">
                        <span class="input-group-text" id="basic-addon1"><i class="bi bi-lock-fill"></i></span>
                        {% render_field form.old_password placeholder="Old Password" name="old_password" aria-label="old_password" aria-describedby="basic-addon1" class+="form-control" %}
                    
                        <!-- Tooltip -->
                        <span class="input-group-text" id="basic-addon1">
                          <span class="tt lead" data-bs-placement="bottom" title="Enter your old password">
                            <i class="bi bi-question-circle text-muted"></i>
                            </span>
                        </span>
                      </div>

                    <!-- Test Password -->

                    <div class="input-group mb-3">
                      
                      <span class="input-group-text" id="basic-addon2"><i class="bi bi-lock-fill"></i></span>
                      {% render_field form.new_password1 type="password" placeholder="New Password" name="new_password1" aria-label="new_password1" aria-describedby="basic-addon2" id="password-input" class+="form-control" %}
                      <!-- Tooltip -->
                      
                      <span class="input-group-text" id="basic-addon1">
                        <span class="tt lead" data-bs-placement="bottom" data-bs-html="true" data-bs-title="<ul><li>Your New Password</li></ul>">
                          <i class="bi bi-question-circle text-muted"></i>
                          </span>
                      </span>
                      <div class="valid-feedback">Good</div>
                      <div class="invalid-feedback">Wrong</div>
                      
                      <div role="alert" id="password-alert" class="alert alert-warning my-3">
                        <small class="text-muted text-start">
                        <ul>
                            <li>
                              <i class="fas fa-check text-success me-2"></i>
                              <i class="fas fa-times text-danger me-3"></i>
                            
                              Password can’t be too similar to your other personal information.
                           
                            </li>
                            <li>
                              <i class="fas fa-check text-success me-2"></i>
                              <i class="fas fa-times text-danger me-3"></i>
                              
                              Password must contain at least 8 characters.
                           
                            </li>
                            <li>
                              <i class="fas fa-check text-success me-2"></i>
                              <i class="fas fa-times text-danger me-3"></i>
                            
                              Password can’t be a commonly used password.
                           
                            </li>
                            <li>
                              <i class="fas fa-check text-success me-2"></i>
                              <i class="fas fa-times text-danger me-3"></i>
                             
                              Password can’t be entirely numeric.
                        
                            </li>
                           
                          </ul>
                        </small>  
                      </div>
                    
                    
                    <div class="input-group mb-3">
                      <span class="input-group-text" id="basic-addon1"><i class="bi bi-bag-check-fill"></i></span>
                      {% render_field form.new_password2 type="password" placeholder="Confirm Password" name="new_password2" aria-label="new_password2" aria-describedby="basic-addon2" class+="form-control" %}
                  
                      <!-- Tooltip -->
                      <span class="input-group-text" id="basic-addon1">
                        <span class="tt lead" data-bs-placement="bottom" title="Your New Password Again.">
                          <i class="bi bi-question-circle text-muted"></i>
                          </span>
                      </span>
                     
                    </div>

                    <div class="mx-auto">
                      <button type="Submit" class="btn btn-primary">Submit</button>
                    </div>
                    </div>
                  </form>
            </div>
          </div>
        </main>

      
        <footer class="mt-5 text-white-50">
          <p>AD Tool for <a href="https://3insys.com/" class="text-white">3INSYS Employees</a>, by <a href="https://3insys.com/" class="text-white">Aziz Shukuri</a></p>
        </footer>
      </div>



    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>

    <script>
      const tooltips = document.querySelectorAll('.tt')
      tooltips.forEach(t => {
        new bootstrap.Tooltip(t)
      })
    </script>

    <script src="{% static 'js/password.js' %}"></script>

  </body>
</html>