{% load widget_tweaks %}
<!-- Model for change password -->
<div class="modal fade" id="changePasswordModal{{user.id}}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
      <div class="modal-content">
        <div class="modal-header">
          <h1 class="modal-title fs-5" id="exampleModalLabel">Change Password for {{user.user_full_name}}</h1>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form method="post" id="changePassword{{user.id}}" oninput='confirm_password.setCustomValidity(confirm_password.value != new_password.value ? "Passwords do not match." : "")'>
            {% csrf_token %}
            <input type="hidden" name="user_input" id="user_input" aria-label="user_input" value="{{user.user_full_name}}" aria-describedby="basic-addon1" class+="form-control">
            <input type="hidden" name="user_dn" id="user_dn" aria-label="user_dn" value="{{user.user_dn}}" aria-describedby="basic-addon1" class+="form-control">
            
            <div class="mb-3">
              <label for="recipient-name" class="col-form-label">New Password:</label>
              {% render_field adpasswordchangeform.new_password type="password" name="new_password" id="new_password" aria-label="new_password" aria-describedby="basic-addon1" class+="form-control" %}
            </div>
            <div class="mb-3">
                <label for="recipient-name" class="col-form-label">Confirm New Password:</label>
                {% render_field adpasswordchangeform.confirm_password type="password" name="confirm_password" id="confirm_password" aria-label="confirm_password" aria-describedby="basic-addon1" class+="form-control" %}
              </div>
              <div class="text-center">
              <br><span id="message"></span><br><br>
              </div>
                
              <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                <button type="submit" class="btn btn-primary">Submit</button>
              </div>
          </form>
        </div>
        
      </div>
    </div>
  </div>
  <script>
    const password = document.getElementById("new_password");
    const confirmPassword = document.getElementById("confirm_password");
    const message = document.getElementById("message");
    const passwordForm = document.getElementById("changePassword{{user.id}}");

    passwordForm.addEventListener("submit", function (event) {
        if (password.value !== confirmPassword.value) {
            message.classList.add("alert");
            message.classList.add("alert-danger");
            message.textContent = "Passwords do not match!";
            event.preventDefault(); // Prevent form submission
        } else {
            message.textContent = "";
        }
    });
</script>


 